<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"  [ ]>

<chapter id="ejb-security">
    <title></title>
    <itemizedlist spacing="compact">
        <listitem><para></para></listitem>
        <listitem><para></para></listitem>
        <listitem><para></para></listitem>
    </itemizedlist>

    <section id="ejb-security-access-control">
        <title>EJB Access Control (Declarative)</title>
        
        <figure>
            <title>EJB Access Control: Annotations</title>
<programlisting language="java"><![CDATA[@Stateless(name="SecurePingEJB")
public class SecurePingEJB implements SecurePingRemote, SecurePingLocal {
    ...
    @PermitAll
    public String pingAll() {
        return getInfo("pingAll");
    }

    @RolesAllowed({"user"})
    public String pingUser() {
        return getInfo("pingUser");
    }

    @RolesAllowed({"admin"})
    public String pingAdmin() {        
        return getInfo("pingAdmin");
    }

    @DenyAll
    public String pingExcluded() {
        return getInfo("pingExcluded");
    }
}]]></programlisting>
        </figure>
        
        <figure>
            <title>EJB Access Control: ejb-jar.xml</title>
<programlisting language="xml"><![CDATA[<assembly-descriptor>
    <security-role>
        <role-name>admin</role-name>
    </security-role>
    <security-role>
        <role-name>user</role-name>
    </security-role>
    <method-permission>
        <unchecked/>
        <method>
            <ejb-name>SecurePingEJB</ejb-name>
            <method-name>pingAllmethod-name>
        </method>
    </method-permission>
    <method-permission>
        <role-name>admin</role-name>
        <method>
            <ejb-name>SecurePingEJB</ejb-name>
            <method-name>pingAdmin</method-name>
        </method>
    </method-permission>
    <method-permission>
        <role-name>user</role-name>
        <method>
            <ejb-name>SecurePingEJB</ejb-name>
            <method-name>pingUser</method-name>
        </method>
    </method-permission>
    <method-permission>
        <excluded/>
        <method>
            <ejb-name>SecurePingEJB</ejb-name>
            <method-name>pingExcluded</method-name>
        </method>
    </method-permission>
</assembly-descriptor>]]></programlisting>
        </figure>

    </section>

    <section id="ejb-security-programmatic">
        <title>Programmatic Security</title>
        
        <figure>
            <title>Programmatic Security Check</title>
<programlisting language="java"><![CDATA[    @Resource
    SessionContext ctx;

        if (ctx.isCallerInRole(role)) { 
            ... 
        }]]></programlisting>
        </figure>
        <itemizedlist spacing="compact">
            <listitem><para>Permits more fine-grain access control down to the object level</para></listitem>
            <listitem><para>role can be literal or a logical mapping (see below)</para></listitem>
        </itemizedlist>
        
        <figure>
            <title>Optional Role Mapping: ejb-jar.xml</title>
<programlisting language="xml"><![CDATA[    <enterprise-beans>
        <session>
            <ejb-name>SecurePingEJB</ejb-name>
            <security-role-ref>
                <description>role-name checked within EJB</description>
                <role-name>internalRole</role-name>
                <role-link>admin</role-link>
            </security-role-ref>
        </session>
    </enterprise-beans>    
    <assembly-descriptor>
        <security-role>
            <role-name>admin</role-name>
        </security-role>
        <security-role>
            <role-name>user</role-name>
        </security-role>
    </assembly-descriptor>]]></programlisting>
        </figure>
        <itemizedlist spacing="compact">
            <listitem><para>Permits role-name within Java code to be mapped to security role</para></listitem>
        </itemizedlist>
        
    </section>

    <section id="ejb-security-">
        <title></title>
        <para></para>
<programlisting language=""><![CDATA[
        ]]></programlisting>
    </section>

    <section id="ejb-security-summary">
        <title>Summary</title>
        <itemizedlist spacing="compact">
            <listitem><para></para></listitem>
            <listitem><para></para></listitem>
            <listitem><para></para></listitem>
        </itemizedlist>
    </section>

</chapter>
  
